<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xml:lang=
"en-US">
<head>
<title>Native Memory Tracking</title>

<script language="javascript1.2" type="text/javascript" src="../../../../../webdesign/pubs8/js/popUp.js"></script>
<script language="javascript1.2" type="text/javascript" src="../../../../../webdesign/pubs8/js/sniff.js"></script>
<script language="javascript1.2" type="text/javascript" src="../../../../../webdesign/pubs8/js/menucontent.js"></script>
<script language="javascript1.2" type="text/javascript" src="../../../../../webdesign/pubs8/js/menucode.js"></script>
<script language="javascript1.2" type="text/javascript" src="../../../../../webdesign/pubs8/js/developer.js"></script>
<script language="javascript1.2" type="text/javascript" src="../../../../../webdesign/other/js/search.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../../webdesign/pubs8/css/default_developer.css" />
<meta name="collection" content="reference"/> 
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<noscript>JavaScript is not supported by your browser. JavaScript
support is required for full functionality of this page.</noscript>
<div class="a0 a0v1" id="a0v1"><!-- BEGIN A1 COMPONENT V.0 -->
<div class="a1 a1r2">
<div class="a1v0"><a href="#skip2content" class="skiplink">Skip to
Content</a></div>
</div>
<!-- END A1 COMPONENT V.0 -->
<!-- BEGIN A2 COMPONENT V.1 -->
<div class="a2w0">
<div class="a2" id="a2v1">
<div class="a2w1">
<div class="a2w2">
<div class="a2w3">
<div class="a2w4">
<div class="a2topiclinks"><a href="http://www.oracle.com" title=
"Oracle Home Page" id="sunlogo" name="sunlogo"><img src=
"../../../../../webdesign/pubs8/im/a.gif" alt="Home Page" width="98" height="58"
border="0" /></a>
<ul id="mtopics">
<li id="mtopic1"><a id="glink1" class="tpclink a2menu" title=
"See Oracle Technology Network" href="http://oracle.com/technology"
name="glink1">Oracle Technology Network</a></li>
<li id="mtopic2"><a id="glink2" class="tpclink a2menu" title=
"Software Downloads" href=
"http://www.oracle.com/technology/software/index.html" name=
"glink2">Software Downloads</a></li>
<li id="mtopic3"><a id="glink3" class="tpclink a2menu" title=
"See Java SE Documentation" href=
"http://docs.oracle.com/javase/index.html" name=
"glink3">Documentation</a></li>
</ul>
<div class="a2search"><a href="../../../../../search.html" target=
"_blank">Search</a></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- END A2 COMPONENT V.1 -->
<!-- BEGIN SEPARATOR -->
<div class="hr">
<hr /></div>
<!-- END SEPARATOR -->
<!-- ============ -->
<!-- MAIN CONTENT -->
<!-- ============ -->
<a name="skip2content" id="skip2content"></a>


<div class="smallpagetitle"><h1>Native Memory Tracking</h1></div>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#features">Key Features</a></li>
<li><a href="#how_to_use">How to Use Native Memory Tracking</a>
<ul>
<li><a href="#enable_nmt">Enable NMT</a></li>
<li><a href="#use_jcmd">Use jcmd to Access NMT Data</a></li>
</ul>
</li>
<li><a href="#nmt_vmexit">NMT at VM Exit</a></li>
</ul>
<h2><a name="overview" id="overview">Overview</a></h2>
<p>The Native Memory Tracking (NMT) is a Java Hotspot VM feature
that tracks internal memory usage for a HotSpot JVM. You can access
NMT data using jcmd utility. NMT in this release does not track
third party native code memory allocations and JDK class libraries.
Also, this release does not include NMT <code>MBean</code> in
HotSpot for JMC.</p>
<h2><a name="features" id="features">Key Features</a></h2>
<p>Native Memory Tracking has the following features and when used
with jcmd can track memory usage at differnet levels.</p>
<ul>
<li>
<p>NMT for Hotspot VM is turned off by default. Turn this feature
on using JVM command line option. See the <a href=
"../../tools/unix/java.html#BABCBGHF">Native Memory Tracking
command man page</a>.</p>
</li>
<li>
<p>Memory tracking data can be accessed using jcmd utility. See
<a href="#use_jcmd">use jcmd to access NMT data</a>.</p>
</li>
<li>
<p>Generate summary and detail reports.</p>
</li>
<li>
<p>Establish an early baseline for later comparison.</p>
</li>
<li>
<p>Request a memory usage report at JVM exit with the JVM command
line option. See <a href="#nmt_vmexit">NMT at VM exit</a>.</p>
</li>
<li>
<p>NMT can be shutdown using jcmd utility, but can not
start/restart using jcmd.</p>
</li>
</ul>
<h2><a name="how_to_use" id="how_to_use">How to Use Native Memory
Tracking</a></h2>
<p>First enable NMT and then use jcmd to access the data collected
thus far.</p>
<h3><a name="enable_nmt" id="enable_nmt">Enable NMT</a></h3>
<p>Enable NMT using the following command line. Note that enabling
this will cause 5-10% performance overhead.</p>
<p><code>-XX:NativeMemoryTracking=[off | summary |
detail]</code></p>
<table border="5" cellpadding="5" frame="border" summary=
"NMT usage options">
<tbody>
<tr>
<td headers="h1">off</td>
<td headers="h2">NMT is turned off by default.</td>
</tr>
<tr>
<td headers="h1">summary</td>
<td headers="h2">Only collect memory usage aggregated by subsystem.</td>
</tr>
<tr>
<td headers="h1">detail</td>
<td headers="h2">Collect memory usage by individual call sites.</td>
</tr>
</tbody>
</table>
<h3><a name="use_jcmd" id="use_jcmd">Use jcmd to Access NMT
Data</a></h3>
<p>Use jcmd to dump the data collected and optionally compare it to
the last baseline.</p>
<p><code>jcmd &lt;pid&gt; VM.native_memory [summary | detail |
baseline | summary.diff | detail.diff | shutdown] [scale= KB | MB |
GB]</code></p>
<table border="5" cellpadding="5" frame="border" summary=
"jcmd nmt option details">
<tbody>
<tr>
<td headers="h101">summary</td>
<td headers="h102">Print a summary aggregated by category.</td>
</tr>
<tr>
<td headers="h101">detail</td>
<td headers="h102">
<ul>
<li>Print memory usage aggregated by category</li>
<li>Print virtual memory map</li>
<li>Print memory usage aggregated by call site</li>
</ul>
</td>
</tr>
<tr>
<td headers="h101">baseline</td>
<td headers="h102">Create a new memory usage snapshot to diff against.</td>
</tr>
<tr>
<td headers="h101">summary.diff</td>
<td headers="h102">Print a new summary report against the last baseline.</td>
</tr>
<tr>
<td headers="h101">detail.diff</td>
<td headers="h102">Print a new detail report against the last baseline.</td>
</tr>
<tr>
<td headers="h101">shutdown</td>
<td headers="h102">Shutdown NMT.</td>
</tr>
</tbody>
</table>
<h2><a name="nmt_vmexit" id="nmt_vmexit">NMT at VM Exit</a></h2>
<p>Use the following VM diagnostic command line option to obtain
last memory usage data at VM exit when Native Memory Tracking is
enabled. The level of detail is based on tracking level.</p>
<p><code>-XX:+UnlockDiagnosticVMOptions -XX:+PrintNMTStatistics</code></p>
<p>See <a href="../troubleshoot/index.html">Troubleshooting
Guide</a> on how to monitor VM internal memory allocations and
diagnose VM memory leaks.</p>

<div id="javasefooter">
<div class="hr">
<hr /></div>
<div id="javasecopyright">
<a href="../../../legal/cpyr.html">Copyright &#169;</a> 1993, 2018, Oracle
and/or its affiliates. All rights reserved.
</div>

<div id="javasecontactus">
<a href="http://docs.oracle.com/javase/feedback.html">Contact Us</a>
</div>
</div>
</div>

<!-- Start SiteCatalyst code -->
<script type="application/javascript" src="https://www.oracleimg.com/us/assets/metrics/ora_docs.js"></script>
<!-- End SiteCatalyst code -->

</body>
</html>
