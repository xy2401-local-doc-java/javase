<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Commands to Work with Directive Files</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="description" content="This topic examines commands and the effects of working with completed directive files." />
<meta name="dcterms.created" content="2017-10-12T08:30:16Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Java Platform, Standard Edition Java Virtual Machine Guide" />
<meta name="dcterms.identifier" content="E68512-05" />
<meta name="dcterms.isVersionOf" content="JSJVM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1993, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="../index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="understanding-directives-better.htm" title="Previous" type="text/html" />
<link rel="Next" href="garbage-collection-enhancements.htm" title="Next" type="text/html" />
<link rel="alternate" href="JSJVM.pdf" title="PDF version" type="application/pdf" />
<link rel="alternate" href="JSJVM.epub" title="ePub version" type="application/epub+zip" />
<link rel="alternate" href="JSJVM.mobi" title="Mobipocket version" type="application/x-mobipocket-ebook" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-88ECC49E-4581-49F6-952F-0EB7E12E8C84"></a> <span id="PAGE" style="display:none;">8/17</span> <!-- End Header -->
<h1 id="JSJVM-GUID-88ECC49E-4581-49F6-952F-0EB7E12E8C84" class="sect1">Commands to Work with Directive Files</h1>
<div>
<p>This topic examines commands and the effects of working with completed directive files.</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="commands-work-directive-files.htm#GUID-3517007F-824A-4079-B374-188C107D9AB2" title="The command line provides an interface to add and print compiler directives while starting a program.">Compiler Directives and the Command Line</a></p>
</li>
<li>
<p><a href="commands-work-directive-files.htm#GUID-4B31D43A-EEBF-47E0-AAB5-9BEB23B7CFC2" title="Diagnostic commands provide an interface to manage which directives are active at runtime. You can add directives to or remove directives from a running program without restarting it.">Compiler Directives and Diagnostic Commands</a></p>
</li>
<li>
<p><a href="commands-work-directive-files.htm#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D" title="The order directives are written in a file, or added to the stack, is very important. The top-most best-matching directive in the stack receives priority and is applied to code compilation.">How Are Directives Ordered in the Directives Stack?</a></p>
</li>
</ul>
</div>
<div class="sect2"><a id="GUID-3517007F-824A-4079-B374-188C107D9AB2"></a>
<h2 id="JSJVM-GUID-3517007F-824A-4079-B374-188C107D9AB2" class="sect2">Compiler Directives and the Command Line</h2>
<div>
<p>The command line provides an interface to add and print compiler directives while starting a program.</p>
<p>Only one directives file is specifiable from the command line. All directives within that file are added to the directives stack and are immediately active as the program starts. This makes it possible to test the performance effects of directives during a program&rsquo;s early stages. You&rsquo;re also free to focus on debugging and developing your program.</p>
<div class="section">
<p class="subhead2">Adding Directives Through the Command Line</p>
<div class="p">The command-line option that specifies a directives file is:
<pre dir="ltr">
XX:CompilerDirectivesFile=<span class="variable">file</span>
</pre>
Include this command-line option when you start a Java program. This is shown in the following example, which starts <code class="codeph">TestProgram</code>:
<pre dir="ltr">
java -XX:+UnlockDiagnosticVMOptions -XX:CompilerDirectivesFile=File_A.json TestProgram
</pre>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">-XX:+UnlockDiagnosticVMOptions</code> enables diagnostic options. You must enter this before working with directives on the command line.</p>
</li>
<li>
<p><code class="codeph">-XX:CompilerDirectivesFile</code> is a type of diagnostic option. It specifies one directives file to add to the directives stack.</p>
</li>
<li>
<p><code class="codeph">File_A.json</code> is a directives file. It contains any number of directives, all of which are added to the stack of active directives as the program starts.</p>
</li>
<li>
<p>If <code class="codeph">File_A.json</code> contains syntax errors or malformed directives, then an error message is displayed and <code class="codeph">TestProgram</code> does not start.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Printing Directives Through the Command Line</p>
<div class="p">It&rsquo;s possible to automatically print the directives stack when a program starts or when additional directives are added through diagnostic commands. The command-line option to enable this behavior is:
<pre dir="ltr">
-XX:+CompilerDirectivesPrint
</pre>
An example of including this diagnostic command on the command line is:
<pre dir="ltr">
java -XX:+UnlockDiagnosticVMOptions -XX:+CompilerDirectivesPrint -XX:CompilerDirectivesFile=File_A.json TestProgram 
</pre></div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect2"><a id="GUID-4B31D43A-EEBF-47E0-AAB5-9BEB23B7CFC2"></a>
<h2 id="JSJVM-GUID-4B31D43A-EEBF-47E0-AAB5-9BEB23B7CFC2" class="sect2">Compiler Directives and Diagnostic Commands</h2>
<div>
<p>Diagnostic commands provide an interface to manage which directives are active at runtime. You can add directives to or remove directives from a running program without restarting it.</p>
<p>Crafting a single perfect directives file may take some iteration and experimentation. However, diagnostic commands provide powerful mechanisms for testing different configurations of directives in the directives stack. Diagnostic commands let you add or remove directives without restarting a running program&rsquo;s JVM.</p>
</div>
<div class="sect3"><a id="GUID-EDDC54D0-F1E9-45C9-A251-C8067B1ABE17"></a>
<h3 id="JSJVM-GUID-EDDC54D0-F1E9-45C9-A251-C8067B1ABE17" class="sect3">Getting Your Java Process Identification Number</h3>
<div>
<p>The first step in testing directives is to find the process identification (pid) number of your running program.</p>
<ol>
<li><span>Open a terminal.</span></li>
<li><span>Enter the following: <kbd class="userinput">jcmd</kbd></span></li>
</ol>
<div class="section">This command returns a list of every Java process running on your machine, along with their pid numbers. For example, you may see the following information returned about <code class="codeph">TestProgram</code>:
<pre dir="ltr">
11084 TestProgram
</pre></div>
<!-- class="section" --></div>
</div>
<div class="sect3"><a id="GUID-AC077891-EB16-42FD-A10B-9FE1D2F4D03B"></a>
<h3 id="JSJVM-GUID-AC077891-EB16-42FD-A10B-9FE1D2F4D03B" class="sect3">Adding Directives Through Diagnostic Commands</h3>
<div>
<p>All directives in a file are added to the directives stack through a single diagnostic command.</p>
<div class="p">Enter the following:
<pre dir="ltr">
jcmd <span class="variable">pid</span> Compiler.directives_add <span class="variable">file</span>
</pre>
An example is:
<pre dir="ltr">
jcmd 11084 Compiler.directives_add File_B.json
</pre>
The terminal reports the number of individual directives added. However, if the directives file contains syntax errors or malformed directives, then an error message is displayed, and no directives from the file are added to the stack. There are no changes to the running program.</div>
</div>
</div>
<div class="sect3"><a id="GUID-11268025-CEE7-4C8A-82A4-B77FB690EFE7"></a>
<h3 id="JSJVM-GUID-11268025-CEE7-4C8A-82A4-B77FB690EFE7" class="sect3">Removing Directives Through Diagnostic Commands</h3>
<div>
<p>There are two diagnostic commands that remove directives.</p>
<div class="p">To remove the top-most, individual directive from the directive stack, enter:
<pre dir="ltr">
jcmd <span class="variable">pid</span> Compiler.directives_remove
</pre>
To clear every directive you added to the directives stack, enter:
<pre dir="ltr">
jcmd <span class="variable">pid</span> Compiler.directives_clear
</pre>
It&rsquo;s not possible to specify an entire file of directives to remove, nor is there any other way to remove directives in bulk.</div>
</div>
</div>
<div class="sect3"><a id="GUID-0BA25646-8CB5-4DC4-A818-97140D83A4D9"></a>
<h3 id="JSJVM-GUID-0BA25646-8CB5-4DC4-A818-97140D83A4D9" class="sect3">Printing Directives Through Diagnostic Commands</h3>
<div>
<p>Diagnostic commands are used to print the directives stack of a running program.</p>
<div class="p">A detailed description of the full directives stack is printed each time you enter:
<pre dir="ltr">
jcmd <span class="variable">pid</span> Compiler.directives_print
</pre>
Example output is shown in <a href="understanding-directives-better.htm#GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61" title="The default directive is a compiler directive that contains default values for all possible directive options. It is at the bottom of the directives stack and matches every method submitted for compilation.">What Is the Default Directive?</a></div>
</div>
</div>
</div>
<div class="sect2"><a id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D"></a>
<h2 id="JSJVM-GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D" class="sect2">How Are Directives Ordered in the Directives Stack?</h2>
<div>
<p>The order directives are written in a file, or added to the stack, is very important. The top-most best-matching directive in the stack receives priority and is applied to code compilation.</p>
<p>Diagrams in this topic illustrate the ordering effects in an example directives stack. There are three directive files in this scenario:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">File_A</code> contains <code class="codeph">Directive 1</code> and <code class="codeph">Directive 2</code>.</p>
</li>
<li>
<p><code class="codeph">File_B</code> contains <code class="codeph">Directive 3</code>.</p>
</li>
<li>
<p><code class="codeph">File_C</code> contains <code class="codeph">Directive 4</code> and <code class="codeph">Directive 5</code>.</p>
</li>
</ul>
<div class="section">
<p class="subhead2">The Initial State of the Directives Stack</p>
<div class="p"><code class="codeph">TestProgram</code> can be started without involving directive files.
<ul style="list-style-type: disc;">
<li>
<div class="p">Enter the following on the command line to start a program without adding any directives:
<pre dir="ltr">
java TestProgram
</pre></div>
</li>
<li>
<p><code class="codeph">TestProgram</code> starts without any directives file specified.</p>
</li>
<li>
<p>The default directive is always at the bottom of the directives stack. <a href="commands-work-directive-files.htm#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-25591A0A-0883-47B2-8BAC-6AF6B7DF3C0C">Figure 2-1</a> shows the default directive as <code class="codeph">Directive 0</code>. When you don&rsquo;t specify a directives file, then the default directive is also the top directive and receives priority.</p>
</li>
</ul>
</div>
<div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-25591A0A-0883-47B2-8BAC-6AF6B7DF3C0C">
<p class="titleinfigure">Figure 2-1 Starting a Program Without Directives</p>
<img width="438" height="215" src="img/jsjvm_dt_005_default.png" alt="Description of Figure 2-1 follows" title="Description of Figure 2-1 follows" /><br />
<a href="img_text/jsjvm_dt_005_default.htm">Description of "Figure 2-1 Starting a Program Without Directives"</a></div>
<!-- class="figure" -->
<div class="p">Alternatively, directives can be added to the directives stack when you start <code class="codeph">TestProgram</code>:
<ul style="list-style-type: disc;">
<li>
<div class="p">Enter the following on the command line to add all directives from <code class="codeph">File_A.json</code> to the directives stack:
<pre dir="ltr">
java -XX:+UnlockDiagnosticVMOptions -XX:CompilerDirectivesFile=File_A.json TestProgram
</pre></div>
</li>
<li>
<p>Directives are added to the stack in the reverse order they&rsquo;re written. The top-most directive in the file becomes the top-most directive on the stack.</p>
</li>
<li>
<p><a href="commands-work-directive-files.htm#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-2BCA3FD8-D759-432F-87ED-D4DD3729F087">Figure 2-2</a> shows that the order of directives in the stack, from top to bottom, becomes: [1, 2, 0].</p>
</li>
</ul>
</div>
<div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-2BCA3FD8-D759-432F-87ED-D4DD3729F087">
<p class="titleinfigure">Figure 2-2 Starting a Program with Directives</p>
<img width="438" height="215" src="img/jsjvm_dt_001_stacka.png" alt="Description of Figure 2-2 follows" title="Description of Figure 2-2 follows" /><br />
<a href="img_text/jsjvm_dt_001_stacka.htm">Description of "Figure 2-2 Starting a Program with Directives"</a></div>
<!-- class="figure" --></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Additions to the Directives Stack</p>
<div class="p">If <code class="codeph">TestProgram</code> is running, then you must supply additional directives through diagnostic commands:
<ul style="list-style-type: disc;">
<li>
<div class="p">Enter the following to add all directives from <code class="codeph">File_B</code> to the directives stack:
<pre dir="ltr">
jcmd 11084 Compiler.directives_add File_B.json
</pre></div>
</li>
<li>
<p><code class="codeph">Directive 3</code> is added to the top of the stack. This is the only directive found in <code class="codeph">File_B</code>.</p>
</li>
<li>
<p><a href="commands-work-directive-files.htm#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-4C6536FE-940A-415F-8CF7-F30E7FB1DB1D">Figure 2-3</a> shows that the order of directives in the stack becomes: [3, 1, 2, 0].</p>
</li>
</ul>
</div>
<div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-4C6536FE-940A-415F-8CF7-F30E7FB1DB1D">
<p class="titleinfigure">Figure 2-3 Adding a Directive to a Running Program</p>
<img width="438" height="215" src="img/jsjvm_dt_002_stackb.png" alt="Description of Figure 2-3 follows" title="Description of Figure 2-3 follows" /><br />
<a href="img_text/jsjvm_dt_002_stackb.htm">Description of "Figure 2-3 Adding a Directive to a Running Program"</a></div>
<!-- class="figure" -->
<div class="p">More directive files can be added through diagnostic commands if <code class="codeph">TestProgram</code> continues running:
<ul style="list-style-type: disc;">
<li>
<div class="p">Enter the following to add all directives from <code class="codeph">File_C</code> to the directives stack.
<pre dir="ltr">
jcmd 11084 Compiler.directives_add File_C.json
</pre></div>
</li>
<li>
<p><a href="commands-work-directive-files.htm#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-214F325E-560B-439B-87D9-CEF7FCEC484B">Figure 2-4</a> shows that the order of directives in the stack becomes: [4, 5, 3, 1, 2, 0].</p>
</li>
</ul>
</div>
<div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-214F325E-560B-439B-87D9-CEF7FCEC484B">
<p class="titleinfigure">Figure 2-4 Adding Many Directives to a Running Program</p>
<img width="438" height="215" src="img/jsjvm_dt_003_stackc.png" alt="Description of Figure 2-4 follows" title="Description of Figure 2-4 follows" /><br />
<a href="img_text/jsjvm_dt_003_stackc.htm">Description of "Figure 2-4 Adding Many Directives to a Running Program"</a></div>
<!-- class="figure" --></div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Removals from the Directives Stack</p>
<div class="p">The top-most directive is removable through diagnostic commands:
<ul style="list-style-type: disc;">
<li>
<div class="p">Enter the following to remove <code class="codeph">Directive 4</code> from the stack:
<pre dir="ltr">
<kbd class="userinput">jcmd 11084 Compiler.directives_remove</kbd>
</pre></div>
</li>
<li>
<p>Top directives are removable one at a time by repeating this diagnostic command until only the default directive remains. You can&rsquo;t remove the default directive.</p>
</li>
<li>
<p><a href="commands-work-directive-files.htm#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-71E5F16A-326E-46F0-8D87-43482E996466">Figure 2-5</a> shows that the order of directives in the stack becomes: [5, 3, 1, 2, 0].</p>
</li>
</ul>
</div>
<div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-71E5F16A-326E-46F0-8D87-43482E996466">
<p class="titleinfigure">Figure 2-5 Removing One Directive from the Stack</p>
<img width="438" height="215" src="img/jsjvm_dt_006_remove.png" alt="Description of Figure 2-5 follows" title="Description of Figure 2-5 follows" /><br />
<a href="img_text/jsjvm_dt_006_remove.htm">Description of "Figure 2-5 Removing One Directive from the Stack"</a></div>
<!-- class="figure" -->
<div class="p">There is one mechanism to bulk-remove directives from the directives stack:
<ul style="list-style-type: disc;">
<li>
<div class="p">Enter the following to clear the directives stack:
<pre dir="ltr">
<kbd class="userinput">jcmd 11084 Compiler.directives_clear</kbd>
</pre></div>
</li>
<li>
<p>All directives are removed at one time except the default directive. You can&rsquo;t remove the default directive.</p>
</li>
<li>
<p><a href="commands-work-directive-files.htm#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-2430733A-6FD5-4BE1-A04C-B569D796325D">Figure 2-6</a> shows that only <code class="codeph">Directive 0</code> remains in the stack.</p>
</li>
</ul>
</div>
<div class="figure" id="GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D__GUID-2430733A-6FD5-4BE1-A04C-B569D796325D">
<p class="titleinfigure">Figure 2-6 Removing All Directives from the Stack</p>
<img width="438" height="215" src="img/jsjvm_dt_004_clear.png" alt="Description of Figure 2-6 follows" title="Description of Figure 2-6 follows" /><br />
<a href="img_text/jsjvm_dt_004_clear.htm">Description of "Figure 2-6 Removing All Directives from the Stack"</a></div>
<!-- class="figure" --></div>
<!-- class="section" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment81">
<tr>
<td class="cellalignment88">
<table class="cellalignment86">
<tr>
<td class="cellalignment85"><a href="understanding-directives-better.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment85"><a href="garbage-collection-enhancements.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1993, 2017, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment90">
<table class="cellalignment84">
<tr>
<td class="cellalignment85"><a href="../index.html"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment85"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment85"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
