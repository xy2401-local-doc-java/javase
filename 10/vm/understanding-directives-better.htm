<!DOCTYPE html>
<html lang="en-US" >
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="UTF-8" />
<title>Understanding Directives</title>
<meta name="generator" content="DITA Open Toolkit version 1.8.5 (Mode = doc)" />
<meta name="description" content="The following topics examine how directives behave and interact." />
<meta name="dcterms.created" content="2018-03-13T05:24:14Z" />
<meta name="robots" content="all" />
<meta name="dcterms.title" content="Java Platform, Standard Edition Java Virtual Machine Guide" />
<meta name="dcterms.identifier" content="E91108-01" />
<meta name="dcterms.isVersionOf" content="JSJVM" />
<meta name="dcterms.rights" content="Copyright&nbsp;&copy;&nbsp;1993, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved." />
<link rel="Start" href="http://docs.oracle.com/javase/10/index.html" title="Home" type="text/html" />
<link rel="Copyright" href="../dcommon/html/cpyr.htm" title="Copyright" type="text/html" />

<script type="application/javascript"  src="../dcommon/js/headfoot.js"></script>
<script type="application/javascript"  src="../nav/js/doccd.js" charset="UTF-8"></script>
<link rel="Contents" href="toc.htm" title="Contents" type="text/html" />
<link rel="Prev" href="writing-directives.htm" title="Previous" type="text/html" />
<link rel="Next" href="commands-work-directive-files.htm" title="Next" type="text/html" />
<link rel="alternate" href="JSJVM.pdf" title="PDF version" type="application/pdf" />
<link rel="schema.dcterms" href="http://purl.org/dc/terms/" />
<link rel="stylesheet" href="../dcommon/css/fusiondoc.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/header.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/footer.css">
<link rel="stylesheet" type="text/css"  href="../dcommon/css/fonts.css">
<link rel="stylesheet" href="../dcommon/css/foundation.css">
<link rel="stylesheet" href="../dcommon/css/codemirror.css">
<link rel="stylesheet" type="text/css" title="Default" href="../nav/css/html5.css">
<link rel="stylesheet" href="../dcommon/css/respond-480-tablet.css">
<link rel="stylesheet" href="../dcommon/css/respond-768-laptop.css">
<link rel="stylesheet" href="../dcommon/css/respond-1140-deskop.css">
<script type="application/javascript" src="../dcommon/js/modernizr.js"></script>
<script type="application/javascript" src="../dcommon/js/codemirror.js"></script>
<script type="application/javascript" src="../dcommon/js/jquery.js"></script>
<script type="application/javascript" src="../dcommon/js/foundation.min.js"></script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-552992c80ef99c8d" async="async"></script>
<script type="application/javascript" src="../dcommon/js/jqfns.js"></script>
<script type="application/javascript" src="../dcommon/js/ohc-inline-videos.js"></script>
<!-- Add fancyBox -->
<link rel="stylesheet" href="../dcommon/fancybox/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>
<!-- Optionally add helpers - button, thumbnail and/or media -->
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-buttons.css?v=1.0.5"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-buttons.js?v=1.0.5"></script>
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-media.js?v=1.0.6"></script>
<link rel="stylesheet"  href="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.css?v=1.0.7"  type="text/css" media="screen" />
<script type="text/javascript" src="../dcommon/fancybox/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>
<script>window.ohcglobal || document.write('<script src="/en/dcommon/js/global.js">\x3C/script>')</script></head>
<body>
<a href="#BEGIN" class="accessibility-top skipto" tabindex="0">Go to main content</a><header><!--
<div class="zz-skip-header"><a id="top" href="#BEGIN">Go to main content</a>--></header>
<div class="row" id="CONTENT">
<div class="IND large-9 medium-8 columns" dir="ltr">
<a id="BEGIN" name="BEGIN"></a>
<a id="GUID-C776A298-BC96-40C7-8028-DB461298DD9F"></a> <span id="PAGE" style="display:none;">7/17</span> <!-- End Header -->
<h1 id="JSJVM-GUID-C776A298-BC96-40C7-8028-DB461298DD9F" class="sect1">Understanding Directives</h1>
<div>
<p>The following topics examine how directives behave and interact.</p>
<div class="section">
<p class="subhead1">Topics:</p>
<ul style="list-style-type: disc;">
<li>
<p><a href="understanding-directives-better.htm#GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61" title="The default directive is a compiler directive that contains default values for all possible directive options. It is the bottom-most directives in the stack and matches every method submitted for compilation.">What Is the Default Directive?</a></p>
</li>
<li>
<p><a href="understanding-directives-better.htm#GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D" title="A directive is applied to code based on a method matching process. Every method submitted for compilation is matched with a directive in the directives stack.">How Directives are Applied to Code?</a></p>
</li>
<li>
<p><a href="understanding-directives-better.htm#GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87" title="CompileCommand and command-line flags can be used alongside Compiler Control directives.">Compiler Control and Backward Compatibility</a></p>
</li>
</ul>
</div>
<!-- class="section" --></div>
<div class="sect2"><a id="GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61"></a>
<h2 id="JSJVM-GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61" class="sect2">What Is the Default Directive?</h2>
<div>
<p>The default directive is a compiler directive that contains default values for all possible directive options. It is the bottom-most directives in the stack and matches every method submitted for compilation.</p>
<p>When you design a new compiler directive, you specify how the new directive differs from the default directive. The default directive becomes a template to guide your design decisions.</p>
<div class="section">
<p class="subhead2">Directive Option Values in the Default Directive</p>
<div class="p">You can print an empty directive stack to reveal the matching criteria and the values for all directive options in the default compiler directive:
<pre dir="ltr">
Directive: (default)
 matching: *.*
 c1 directives:
  inline: -
  Enable:true Exclude:false BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000

 c2 directives:
  inline: -
  Enable:true Exclude:false BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000
</pre>
<div class="infobox-note" id="GUID-1011AB83-1C0E-4C4B-B302-4CD487F25C61__GUID-CD45A841-50FA-4EB4-BC4D-C9EC20C4D32B">
<p class="notep1">Note:</p>
Certain options are applicable exclusively to the <code class="codeph">c2</code> compiler. For a complete list, see <a href="writing-directives.htm#GUID-FF488969-AFCD-48ED-93F5-A49C6C893D39__C2OPTIONS-61F28E20" title="Options exclusive to the c2 compiler">Table 2-2</a>.</div>
</div>
</div>
<!-- class="section" -->
<div class="section">
<p class="subhead2">Directive Option Values in New Directives</p>
<p>In a new directives, you must specify how the directive differs from the default directive. If you don&rsquo;t specify a directive option, then that option retains the value from the default directive.</p>
<div class="p">Example:
<pre dir="ltr">
[
    {
        match: ["*Concurrent.*"],
        c2: {
            MaxNodeLimit: 1000,
        },
        Exclude:true,
    },
]
</pre>
When you add a new directive to the directives stack, the default directive becomes the bottom-most directive in the stack. See <a href="commands-work-directive-files.htm#GUID-0BE73FEB-C133-4907-869A-42F9E4646E9D" title="The order of the directives in a directives file, and in the directives is very important. The top-most, best-matching directive in the stack receives priority and is applied to code compilation.">How Directives Are Ordered in the Directives Stack?</a> for a description of this process. For this example, when you print the directives stack, it shows how the directive options specified in the new directive differ from the values in the default directive:
<pre dir="ltr">
Directive:
 matching: *Concurrent.*
 c1 directives:
  inline: -
  Enable:true Exclude:true BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000 

 c2 directives:
  inline: -
  Enable:true Exclude:true BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:1000 


Directive: (default)
 matching: *.*
 c1 directives:
  inline: -
  Enable:true Exclude:false BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000 

 c2 directives:
  inline: -
  Enable:true Exclude:false BreakAtExecute:false BreakAtCompile:false Log:false PrintAssembly:false PrintInlining:false PrintNMethods:false BackgroundCompilation:true ReplayInline:false DumpReplay:false DumpInline:false CompilerDirectivesIgnoreCompileCommands:false DisableIntrinsic: BlockLayoutByFrequency:true PrintOptoAssembly:false PrintIntrinsics:false TraceOptoPipelining:false TraceOptoOutput:false TraceSpilling:false Vectorize:false VectorizeDebug:0 CloneMapDebug:false IGVPrintLevel:0 MaxNodeLimit:80000 
</pre></div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect2"><a id="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D"></a>
<h2 id="JSJVM-GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D" class="sect2">How Directives are Applied to Code?</h2>
<div>
<p>A directive is applied to code based on a method matching process. Every method submitted for compilation is matched with a directive in the directives stack.</p>
<p>The process of matching a method with a directive in the directives stack is performed by the CompilerBroker.</p>
<div class="section">
<p class="subhead2">The Method Matching Process</p>
<p>When a method is submitted for compilation, the fully qualified name of the method is compared with the matching criteria in the directives stack. The first directive in the stack that matches is applied to the method. The remaining directives in the stack are ignored. If no match is found, then the default directive is applied.</p>
<p>This process is repeated for all methods in a compilation. More than one directive can be applied in a compilation, but only one directive is applied to each method. All directives in the stack are considered active because they are potentially applicable. The key differences between active and applied directives are:</p>
<ul style="list-style-type: disc;">
<li>
<p>A directive is active if it&rsquo;s present in the directives stack.</p>
</li>
<li>
<p>A directive is applied if it&rsquo;s affecting code.</p>
</li>
</ul>
</div>
<!-- class="section" -->
<div class="example" id="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D__WHENAMATCHISFOUND-573E11E1">
<p class="titleinexample">Example 2-1 When a Match Is Found</p>
<div class="p">The following example shows a method submitted for compilation:
<pre dir="ltr">
public int exampleMethod(int x){
        return x;
}
</pre>
Based on method-matching criteria, <code class="codeph">Directive 2</code> is applied from the following example directive stack:
<pre dir="ltr">
Directive 2:
 matching: *.*example*
Directive 1:
 matching: *.*exampleMethod*
Directive 0: (default)
 matching: *.*
</pre></div>
</div>
<!-- class="example" -->
<div class="example" id="GUID-FB010DC3-9E3C-4D19-AEDE-9527DAA1AD7D__WHENNOMATCHISFOUND-573E14F6">
<p class="titleinexample">Example 2-2 When No Match Is Found</p>
<div class="p">The following example shows a method submitted for compilation:
<pre dir="ltr">
public int otherMethod(int y){
        return y;
}
</pre>
Based on method-matching criteria, <code class="codeph">Directive 0</code> (the default directive) is applied from the following example directive stack:
<pre dir="ltr">
Directive 2:
 matching: *.*example*
Directive 1:
 matching: *.*exampleMethod*
Directive 0: (default)
 matching: *.*
</pre></div>
</div>
<!-- class="example" -->
<div class="section">
<p class="subhead2">Guidelines for Writing a New Directive</p>
<div class="p">
<ul style="list-style-type: disc;">
<li>
<p>No feedback mechanism is provided to verify which directive is applied to a given method. Instead, a profiler such as Java Management Extensions (JMX) is used to measure the cumulative effects of applied directives.</p>
</li>
<li>
<p>The CompilerBroker ignores directive options that create bad code, such as forcing hardware instructions on a platform that doesn't offer support. A warning message is displayed.</p>
</li>
<li>
<p>Directive options have the same limitations as typical command-line flags. For example, the instructions to inline code are followed only if the Intermediate Representation (IR) doesn&rsquo;t become too large.</p>
</li>
</ul>
</div>
</div>
<!-- class="section" --></div>
</div>
<div class="sect2"><a id="GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87"></a>
<h2 id="JSJVM-GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87" class="sect2">Compiler Control and Backward Compatibility</h2>
<div>
<p>CompileCommand and command-line flags can be used alongside Compiler Control directives.</p>
<div class="p">Although Compiler Control can replace CompileCommand, backward compatibility is provided. It&rsquo;s possible to utilize both at the same time. Compiler Control receives priority. Conflicts are handled based on the following prioritization:
<ol>
<li>
<p>Compiler Control</p>
</li>
<li>
<p>CompileCommand</p>
</li>
<li>
<p>Command-line flags</p>
</li>
<li>
<p>Default values</p>
</li>
</ol>
</div>
<div class="example" id="GUID-AC93D367-C00F-4054-83A0-42C4BD5C4F87__GUID-DCEFB89D-AA73-484F-B97A-270D472486A8">
<p class="titleinexample">Example 2-3 Mixing Compiler Control and CompileCommand</p>
<div class="p">The following list shows a small number of compilation options and values:
<ul style="list-style-type: disc;">
<li>
<p>Compiler Control:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">Exclude: true</code></p>
</li>
<li>
<p><code class="codeph">BreakAtExecute: false</code></p>
</li>
</ul>
</li>
<li>
<p>CompileCommand:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">BreakAtExecute: true</code></p>
</li>
<li>
<p><code class="codeph">BreakAtCompile: true</code></p>
</li>
</ul>
</li>
<li>
<p>Default values:</p>
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">Exclude: false</code></p>
</li>
<li>
<p><code class="codeph">BreakAtExecute: false</code></p>
</li>
<li>
<p><code class="codeph">BreakAtCompile: false</code></p>
</li>
<li>
<p><code class="codeph">Log: false</code></p>
</li>
</ul>
</li>
</ul>
For the options and values in this example, the resulting compilation is determined by using the rules for handling backward compatibility conflicts:
<ul style="list-style-type: disc;">
<li>
<p><code class="codeph">Exclude: true</code></p>
</li>
<li>
<p><code class="codeph">BreakAtExecute: false</code></p>
</li>
<li>
<p><code class="codeph">BreakAtCompile: true</code></p>
</li>
<li>
<p><code class="codeph">Log: false</code></p>
</li>
</ul>
</div>
</div>
<!-- class="example" --></div>
</div>
</div>
<!-- class="ind" --><!-- Start Footer -->
</div>
<!-- add extra wrapper close div-->
<footer><!--
<hr />
<table class="cellalignment82">
<tr>
<td class="cellalignment89">
<table class="cellalignment87">
<tr>
<td class="cellalignment86"><a href="writing-directives.htm"><img width="24" height="24" src="../dcommon/gifs/leftnav.gif" alt="Go to previous page" /><br />
<span class="icon">Previous</span></a></td>
<td class="cellalignment86"><a href="commands-work-directive-files.htm"><img width="24" height="24" src="../dcommon/gifs/rightnav.gif" alt="Go to next page" /><br />
<span class="icon">Next</span></a></td>
</tr>
</table>
</td>
<td class="cellalignment-copyrightlogo"><img width="144" height="18" src="../dcommon/gifs/oracle.gif" alt="Oracle" /><br />
Copyright&nbsp;&copy;&nbsp;1993, 2018, Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.<br />
<a href="../dcommon/html/cpyr.htm">Legal Notices</a></td>
<td class="cellalignment91">
<table class="cellalignment85">
<tr>
<td class="cellalignment86"><a href="http://docs.oracle.com/javase/10/index.html"><img width="24" height="24" src="../dcommon/gifs/doclib.gif" alt="Go to Documentation Home" /><br />
<span class="icon">Home</span></a></td>
<td class="cellalignment86"><a href="toc.htm"><img width="24" height="24" src="../dcommon/gifs/toc.gif" alt="Go to Table of Contents" /><br />
<span class="icon">Contents</span></a></td>
<td class="cellalignment86"><a href="../dcommon/html/feedback.htm"><img width="24" height="24" src="../dcommon/gifs/feedbck2.gif" alt="Go to Feedback page" /><br />
<span class="icon">Contact Us</span></a></td>
</tr>
</table>
</td>
</tr>
</table>
--></footer>
<noscript>
<p>Scripting on this page enhances content navigation, but does not change the content in any way.</p>
</noscript>
</body>
</html>
